{% extends 'base_agente.html' %}

{% block content %}
<div class="container mt-4">
  <h2>ğŸ“„ Detalhes da DenÃºncia #{{ denuncia.id }}</h2>

  <div class="card my-4">
    <div class="card-body">
      <p><strong>Status:</strong> {{ denuncia.status }}</p>
      <p><strong>Data de CriaÃ§Ã£o:</strong> {{ denuncia.data.strftime('%d/%m/%Y %H:%M') if denuncia.data }}</p>
      <p><strong>EndereÃ§o:</strong> {{ denuncia.endereco or 'NÃ£o informado' }}</p>
      <p><strong>Bairro:</strong> {{ denuncia.bairro or 'NÃ£o informado' }}</p>
      <p><strong>Resultado IA:</strong>
        {% if denuncia.resultado_ia %}
          <span class="badge bg-danger">Positivo</span>
        {% else %}
          <span class="badge bg-success">Negativo</span>
        {% endif %}
      </p>
      <p><strong>ComentÃ¡rio:</strong> {{ denuncia.comentario or 'Nenhum' }}</p>
      <p><strong>LocalizaÃ§Ã£o:</strong>
        {% if denuncia.latitude and denuncia.longitude %}
          <a href="https://www.google.com/maps?q={{ denuncia.latitude }},{{ denuncia.longitude }}" target="_blank">
            Ver no mapa
          </a>
        {% else %}
          NÃ£o disponÃ­vel
        {% endif %}
      </p>
      {% if denuncia.imagem %}
        <p><strong>Imagem enviada:</strong></p>
        <img src="{{ url_for('static', filename='uploads/' ~ denuncia.imagem) }}" alt="Imagem da denÃºncia" class="img-fluid mb-3" style="max-width: 400px;">
      {% endif %}
    </div>
  </div>

  {% if denuncia.status != 'Encerrado' %}
  <form action="{{ url_for('agente_routes.encerrar_denuncia', id=denuncia.id) }}" method="post">
    <div class="mb-3">
      <label for="comentario" class="form-label">Adicionar ComentÃ¡rio:</label>
      <textarea name="comentario" id="comentario" rows="3" class="form-control"></textarea>
    </div>
    <button type="submit" class="btn btn-success">âœ… Encerrar DenÃºncia</button>
  </form>
  {% else %}
    <div class="alert alert-success">DenÃºncia jÃ¡ encerrada em {{ denuncia.data_encerramento.strftime('%d/%m/%Y') if denuncia.data_encerramento }}</div>
  {% endif %}

</div>
{% endblock %}
